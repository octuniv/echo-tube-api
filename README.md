# EchoTube API Server ğŸš€

NestJS ê¸°ë°˜ ë™ì˜ìƒ ê³µìœ  ì»¤ë®¤ë‹ˆí‹° ë°±ì—”ë“œ ì„œë²„

---

## âœ¨ í•µì‹¬ ê¸°ëŠ¥

### 1. **ì‚¬ìš©ì ìƒì„±í˜• ì»¤ë®¤ë‹ˆí‹°**

- ì‚¬ìš©ìëŠ” ë´‡ ì „ìš© ê²Œì‹œíŒ ì™¸ì—ë„ ì¼ë°˜ ê²Œì‹œíŒì„ í†µí•´ ì§ì ‘ ê²Œì‹œë¬¼ì„ ìƒì„±, ìˆ˜ì •, ì‚­ì œ ê°€ëŠ¥
- ëŒ“ê¸€ ì‹œìŠ¤í…œì„ í†µí•´ ì‚¬ìš©ì ê°„ ìƒí˜¸ì‘ìš© ê°•í™”
- ê²Œì‹œë¬¼ ë° ëŒ“ê¸€ì— ëŒ€í•œ ì¢‹ì•„ìš” ê¸°ëŠ¥ ì§€ì›

### 2. **ê¸°ë³¸ ê¸°ëŠ¥**

#### 2-1. ê²Œì‹œë¬¼ ê´€ë¦¬

| HTTP ë©”ì„œë“œ | ì—”ë“œí¬ì¸íŠ¸      | ê¸°ëŠ¥                 | ì¸ì¦ í•„ìš” |
| ----------- | --------------- | -------------------- | --------- |
| POST        | /posts          | ê²Œì‹œë¬¼ ìƒì„±          | O         |
| GET         | /posts          | ì „ì²´ ê²Œì‹œë¬¼ ì¡°íšŒ     | X         |
| GET         | /posts/user/:id | ì‚¬ìš©ìë³„ ê²Œì‹œë¬¼ ì¡°íšŒ | X         |
| PATCH       | /posts/:id      | ê²Œì‹œë¬¼ ìˆ˜ì •          | O         |
| DELETE      | /posts/:id      | ê²Œì‹œë¬¼ ì‚­ì œ          | O         |
| POST        | /posts/like/:id | ê²Œì‹œë¬¼ ì¢‹ì•„ìš”        | O         |

#### 2-2. ëŒ“ê¸€ ì‹œìŠ¤í…œ

| HTTP ë©”ì„œë“œ | ì—”ë“œí¬ì¸íŠ¸             | ê¸°ëŠ¥                    |
| ----------- | ---------------------- | ----------------------- |
| POST        | /comments              | ëŒ“ê¸€/ëŒ€ëŒ“ê¸€ ìƒì„±        |
| GET         | /comments/post/:postId | ëŒ“ê¸€ ëª©ë¡ ì¡°íšŒ (í˜ì´ì§•) |
| PUT         | /comments/:id          | ëŒ“ê¸€ ìˆ˜ì •               |
| DELETE      | /comments/:id          | ëŒ“ê¸€ ì‚­ì œ               |
| POST        | /comments/like/:id     | ëŒ“ê¸€ ì¢‹ì•„ìš”             |

**ì£¼ìš” íŠ¹ì§•**:

- ëŒ€ëŒ“ê¸€ì€ ìµœëŒ€ 2ë‹¨ê³„ê¹Œì§€ë§Œ ì§€ì›
- ì†Œí”„íŠ¸ ì‚­ì œ ì •ì±… ì ìš© (ì‚­ì œëœ ëŒ“ê¸€ì€ "[ì‚­ì œëœ ëŒ“ê¸€]"ë¡œ í‘œì‹œ)
- ì¢‹ì•„ìš”ëŠ” í•œ ë²ˆë§Œ ê°€ëŠ¥ (ì¤‘ë³µ ìš”ì²­ ë¬´ì‹œ)
- í˜ì´ì§• ì¡°íšŒ ì‹œ ë¶€ëª¨ ëŒ“ê¸€ì€ ìµœì‹ ìˆœ, ëŒ€ëŒ“ê¸€ì€ ì‘ì„±ìˆœ ì •ë ¬

### 3. **ê´€ë¦¬ì ì „ìš© ê¸°ëŠ¥**

ê´€ë¦¬ìëŠ” ì¹´í…Œê³ ë¦¬, ê²Œì‹œíŒ, ì‚¬ìš©ì ê³„ì •ì„ ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” ì „ìš© APIë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### 3-1. ì¹´í…Œê³ ë¦¬ ê´€ë¦¬

- **ê¸°ëŠ¥**: ì¹´í…Œê³ ë¦¬ ìƒì„±, ìˆ˜ì •, ì‚­ì œ, ì¡°íšŒ ë° ìŠ¬ëŸ¬ê·¸ ê´€ë¦¬
- **API ì—”ë“œí¬ì¸íŠ¸**: `/admin/categories`
- **ì£¼ìš” ì œì•½ì‚¬í•­**:
  - ì¹´í…Œê³ ë¦¬ ì´ë¦„ì€ ê³ ìœ í•´ì•¼ í•¨
  - ìŠ¬ëŸ¬ê·¸ëŠ” ì†Œë¬¸ì, ìˆ«ì, í•˜ì´í”ˆ(-)ë§Œ ì‚¬ìš© ê°€ëŠ¥ (ì–¸ë”ìŠ¤ì½”ì–´(\_) ê¸ˆì§€)
  - ìµœì†Œ 1ê°œ ì´ìƒì˜ ìŠ¬ëŸ¬ê·¸ ë“±ë¡ í•„ìˆ˜
  - AI_DIGEST ê²Œì‹œíŒ ìƒì„± ì‹œ `USER` ì´ìƒì˜ ê¶Œí•œ í•„ìš”
- **ì¶”ê°€ ê¸°ëŠ¥**:
  - ìŠ¬ëŸ¬ê·¸ ì¤‘ë³µ ê²€ì¦ API (`/admin/categories/validate-slug`)
  - ì¹´í…Œê³ ë¦¬ ì´ë¦„ ì¤‘ë³µ ê²€ì¦ API (`/admin/categories/validate-name`)
  - ì‚¬ìš© ê°€ëŠ¥í•œ ì¹´í…Œê³ ë¦¬ ë° ìŠ¬ëŸ¬ê·¸ ì¡°íšŒ (`/admin/categories/available`)

#### 3-2. ê²Œì‹œíŒ ê´€ë¦¬

- **ê¸°ëŠ¥**: ê²Œì‹œíŒ ìƒì„±, ìˆ˜ì •, ì‚­ì œ, ì¡°íšŒ
- **API ì—”ë“œí¬ì¸íŠ¸**: `/admin/boards`
- **ê²Œì‹œíŒ íƒ€ì…**:
  - `GENERAL`: ì¼ë°˜ í† ë¡  ê³µê°„
  - `AI_DIGEST`: ì„œë²„ì™€ ì—°ë™ëœ ë´‡ ì „ìš© ê²Œì‹œíŒìœ¼ë¡œ, ì¼ë°˜ ì‚¬ìš©ìì˜ ì§ì ‘ì ì¸ ê²Œì‹œë¬¼ ìƒì„±/ìˆ˜ì •/ì‚­ì œê°€ ê¸ˆì§€ë©ë‹ˆë‹¤.
    ì´ íƒ€ì…ì˜ ê²Œì‹œíŒì€ ì™¸ë¶€ ë´‡ì´ íŠ¹ì • ì£¼ì œë¥¼ ìë™ìœ¼ë¡œ ìˆ˜ì§‘í•˜ì—¬ ê´€ë ¨ ì˜ìƒ ì½˜í…ì¸ ë¥¼ ì •ê¸°ì ìœ¼ë¡œ ë“±ë¡í•˜ëŠ” ìš©ë„ë¡œë§Œ ì‚¬ìš©ë˜ë©°,
    ì‚¬ìš©ìëŠ” ì½ê¸° ì „ìš©ìœ¼ë¡œë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. (USER ì´ìƒì˜ ê¶Œí•œ í•„ìš”)
- **ì£¼ìš” ì œì•½ì‚¬í•­**:
  - ìŠ¬ëŸ¬ê·¸ëŠ” ì¹´í…Œê³ ë¦¬ ë‚´ì—ì„œ ê³ ìœ í•´ì•¼ í•¨
  - AI_DIGEST íƒ€ì… ê²Œì‹œíŒì€ USER ì´ìƒì˜ ê¶Œí•œë§Œ ìƒì„± ê°€ëŠ¥
  - ê²Œì‹œíŒ ì‚­ì œ ì‹œ ì—°ê´€ëœ ëª¨ë“  ê²Œì‹œë¬¼ì´ í•¨ê»˜ ì‚­ì œë¨

#### 3-3. ì‚¬ìš©ì ê´€ë¦¬

- **ê¸°ëŠ¥**: ì‚¬ìš©ì ìƒì„±, ìˆ˜ì •, ì‚­ì œ, ê²€ìƒ‰ ë° í˜ì´ì§€ë„¤ì´ì…˜
- **API ì—”ë“œí¬ì¸íŠ¸**: `/admin/users`
- **ì£¼ìš” ê¸°ëŠ¥**:
  - ë‹‰ë„¤ì„/ì´ë©”ì¼ ì¤‘ë³µ ê²€ì‚¬
  - ì—­í• (ADMIN/USER/BOT) ê´€ë¦¬
  - ì†Œí”„íŠ¸ ì‚­ì œ(soft delete) ê¸°ëŠ¥
  - ê²€ìƒ‰ ë° í•„í„°ë§ ê¸°ëŠ¥ (ì´ë©”ì¼, ë‹‰ë„¤ì„, ì—­í•  ê¸°ì¤€)
  - í˜ì´ì§€ë„¤ì´ì…˜ ë° ì •ë ¬ (createdAt, updatedAt ê¸°ì¤€)
- **ì‚¬ìš©ì ì—­í• **:
  - `ADMIN`: ëª¨ë“  ê´€ë¦¬ì ê¸°ëŠ¥ ì‚¬ìš© ê°€ëŠ¥
  - `USER`: ì¼ë°˜ ì‚¬ìš©ì ê¶Œí•œ
  - `BOT`: ì‹œìŠ¤í…œ ë´‡ ì „ìš© ê³„ì •

ì´ ê¸°ëŠ¥ë“¤ì€ ê´€ë¦¬ìê°€ ì»¤ë®¤ë‹ˆí‹°ì˜ êµ¬ì¡°ì™€ ì‚¬ìš©ì ë°ì´í„°ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ê´€ë¦¬í•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤. ê´€ë¦¬ì ì „ìš© APIëŠ” ADMIN ì—­í• ì„ ê°€ì§„ ì‚¬ìš©ìë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆìœ¼ë©°, JWT í† í°ì„ í†µí•´ ì¸ì¦ë©ë‹ˆë‹¤. ìƒì„¸í•œ API ìŠ¤í™ì€ Swagger ë¬¸ì„œì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### 4. **ë´‡ ì „ìš© ê¸°ëŠ¥**

1. **ì˜ìƒ ìˆ˜ì§‘ ëŒ€ìƒ ê²Œì‹œíŒ ì¡°íšŒ**

   - **ì—”ë“œí¬ì¸íŠ¸**: `GET /boards/scraping-targets`
   - **íŠ¹ì§•**: AI_DIGEST íƒ€ì… ê²Œì‹œíŒë§Œ ë°˜í™˜, BOT ì—­í• ë§Œ ì ‘ê·¼ ê°€ëŠ¥

2. **ì˜ìƒ ê²Œì‹œë¬¼ ìƒì„±**
   - **ì—”ë“œí¬ì¸íŠ¸**: `POST /harvest/videos?slug={boardSlug}`
   - **ìš”ì²­ ë³¸ë¬¸**: ìœ íŠœë¸Œ ID, ì œëª©, ì¸ë„¤ì¼ URL ë“± ì˜ìƒ ë©”íƒ€ë°ì´í„°

---

## ğŸ›  ê¸°ìˆ  ìŠ¤íƒ

| Category  | Technology           |
| --------- | -------------------- |
| Framework | NestJS, Express      |
| Database  | PostgreSQL (TypeORM) |
| Auth      | Passport.js, JWT     |
| API Docs  | Swagger UI           |

---

## ğŸ“„ API ë¬¸ì„œ

ìƒì„¸í•œ API ìŠ¤í™ì€ Swaggerë¥¼ í†µí•´ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤.

- **ì ‘ê·¼ ë°©ë²•**: ì„œë²„ ì‹¤í–‰ í›„ [http://localhost:3000/api-docs](http://localhost:3000/api-docs) ì ‘ì†
- **ì¸ì¦**: `Authorize` ë²„íŠ¼ì„ í†µí•´ JWT í† í° ì…ë ¥ (Bearer {your_jwt_token})

> ğŸ’¡ **ì°¸ê³ **: ìƒì„¸í•œ ìš”ì²­/ì‘ë‹µ êµ¬ì¡°, ì˜¤ë¥˜ ì½”ë“œ, ì¸ì¦ ì •ë³´ ë“±ì€ Swagger ë¬¸ì„œì—ì„œ í™•ì¸í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.

---

## ğŸš€ ì‹œì‘í•˜ê¸° (Quick Start)

```bash
# 1. ì €ì¥ì†Œ í´ë¡ 
git clone https://github.com/octuniv/echo-tube-api.git
cd echo-tube-api

# 2. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
cp .env.example .env
cp .env.example .env.test
# .env ë° .env.test íŒŒì¼ì— DATABASE ì„¸íŒ… ê°’, JWT_SECRET ë“± ì„¤ì •

# 3. ì˜ì¡´ì„± ì„¤ì¹˜ ë° ë§ˆì´ê·¸ë ˆì´ì…˜
pnpm install
pnpm run migraiton:generate
pnpm run migration:run

# 4. ê°œë°œ ì„œë²„ ì‹¤í–‰
pnpm run start:testEnv
```

## ğŸ›  ë¹Œë“œ & ì‹¤í–‰ ë°©ë²•

### 1. **í”„ë¡œì íŠ¸ ë¹Œë“œ**

```bash
# ê°œë°œ í™˜ê²½ ë¹Œë“œ (watch ëª¨ë“œ)
pnpm run start:dev

# í”„ë¡œë•ì…˜ ë¹Œë“œ
pnpm run build

# í”„ë¡œë•ì…˜ ì„œë²„ ì‹¤í–‰
pnpm run start:prod

# í…ŒìŠ¤íŠ¸ ì „ìš© ì„œë²„ ì‹¤í–‰
pnpm run start:testEnv
# ìœ„ ì„œë²„ì—ì„œ ì‹¤í–‰í•œ ê²°ê³¼ë¬¼ì€ ë‹¤ìŒ ì‹¤í–‰ ì‹œ ì´ˆê¸°í™” ë¨.
```

### 2. **ë§ˆì´ê·¸ë ˆì´ì…˜**

```bash
# ë§ˆì´ê·¸ë ˆì´ì…˜ ìƒì„± (Entity ë³€ê²½ í›„)
pnpm run migration:generate

# ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰
pnpm run migration:run

# ë§ˆì´ê·¸ë ˆì´ì…˜ ë¡¤ë°±
pnpm run migration:revert

# ì´ˆê¸° ë°ì´í„° ì‹œë”© (Seed)
pnpm run seed:run
# ì„œë²„ ì‹¤í–‰ ì‹œ ì‹œë”© ë¯¸ì ìš© ë¶€ë¶„ì€ ìë™ìœ¼ë¡œ ì‹œë”©ì´ ì‹¤í–‰ë¨.
```

### 3. **í…ŒìŠ¤íŠ¸ ì‹¤í–‰**

```bash
# ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
pnpm test

# í…ŒìŠ¤íŠ¸ ì‹¤ì‹œê°„ ê°ì‹œ ëª¨ë“œ
pnpm run test:watch

# í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ í™•ì¸
pnpm run test:cov

# E2E í…ŒìŠ¤íŠ¸
pnpm run test:e2e

# í…ŒìŠ¤íŠ¸ ë””ë²„ê¹…
pnpm run test:debug
```
